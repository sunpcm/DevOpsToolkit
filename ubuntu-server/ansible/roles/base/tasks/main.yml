---
# ansible/roles/base/tasks/main.yml

- name: Update apt cache
  apt:
    update_cache: yes
    cache_valid_time: 3600

- name: Install base packages
  apt:
    name: "{{ item }}"
    state: present
  loop: "{{ base_packages }}"

- name: Set timezone to Asia/Shanghai
  timezone:
    name: Asia/Shanghai

- name: Ensure locale is set
  locale_gen:
    name: en_US.UTF-8
    state: present

- name: Update system locale configuration
  shell: update-locale LANG=en_US.UTF-8 LC_ALL=en_US.UTF-8
  args:
    creates: /etc/default/locale

- name: Display system info
  debug:
    msg:
      - "Base packages installed"
      - "System updated and configured"
      - "Locale: en_US.UTF-8"
      - "Timezone: Asia/Shanghai"
      - "Base packages installed"
      - "System updated and configured"
